# プロダクトレビュー会議書類

**作成日:** 2026-01-29
**目的:** 自主製作レベルから外部公開可能なプロダクトへの昇華
**対象:** RigLab v1.0 リリース前検証

---

## 1. 現状サマリー

| 項目 | 状態 |
|------|------|
| バックエンド | 90% 完了（モデル、API、サービス完了） |
| フロントエンド | Phase 4完了、Phase 5 (管理画面) 未着手 |
| 認証 | NextAuth.js + JWT 統合完了 |
| ドキュメント | 全9種完了 |

**残タスク:**
- [ ] 管理者画面 UI（8タスク）

---

## 2. 設計仕様 vs 実装 突合チェックリスト

### 2.1 コア機能（要件定義書 FR-001〜005）

| ID | 機能 | 設計仕様 | 実装状況 | 確認 | 備考 |
|----|------|----------|----------|------|------|
| FR-001 | おまかせ構成提案 | 予算・用途から最適構成を提案 | [ ] 未確認 | [ ] | PartsRecommendationService 検証要 |
| FR-002 | カスタム構成作成 | パーツ選択、互換性チェック、自動推奨 | [ ] 未確認 | [ ] | CompatibilityCheckService 検証要 |
| FR-003 | 構成保存・管理 | ログインユーザーのみ保存・編集・削除 | [ ] 未確認 | [ ] | |
| FR-004 | 構成共有 | URLエンコード＋OG画像生成 | [ ] 未確認 | [ ] | share_token 動作確認要 |
| FR-005 | ユーザー認証 | Credentials認証、JWT検証 | [ ] 未確認 | [ ] | NextAuth.js + Rails JWT連携 |

**確認質問:**
- [ ] おまかせ構成の推奨ロジックは期待通り動作しているか？
- [ ] 互換性チェックは全パターン（CPU/メモリ/マザーボード/GPU/ケース）網羅しているか？
- [ ] OG画像は正しく生成・表示されるか？

---

### 2.2 管理者機能（要件定義書 FR-101〜103）

| ID | 機能 | 設計仕様 | 実装状況 | 確認 | 備考 |
|----|------|----------|----------|------|------|
| FR-101 | パーツ管理 | CRUD（管理者のみ） | API完了 / UI未着手 | [ ] | |
| FR-102 | おまかせ構成管理 | テンプレートCRUD | API完了 / UI未着手 | [ ] | |
| FR-103 | ユーザー管理 | 一覧表示、権限管理 | 未着手（低優先度） | [ ] | v1.0スコープ外でOK？ |

---

### 2.3 非機能要件チェック

| ID | 要件 | 設計仕様 | 確認 | 現状/課題 |
|----|------|----------|------|-----------|
| NFR-001 | デバイス対応 | PC/スマホ/タブレット | [ ] | 実機テスト要 |
| NFR-002 | レスポンシブ | モバイルファースト | [ ] | ブレークポイント確認要 |
| NFR-003 | レスポンス時間 | ページ3秒/API 500ms以内 | [ ] | パフォーマンス計測未実施 |
| NFR-004 | 認証・認可 | JWT、パスワード要件、ログイン制限 | [ ] | ログイン試行制限は実装済？ |
| NFR-005 | 通信セキュリティ | HTTPS、CORS、CSP | [ ] | 本番環境設定確認要 |
| NFR-006 | データ保護 | bcrypt、SQLi/XSS/CSRF対策 | [ ] | |
| NFR-007 | 権限管理 | ゲスト/ユーザー/管理者の3ロール | [ ] | role カラム確認済 |

---

## 3. 画面フロー検証

### 3.1 ユーザー向け画面

| 画面 | URL | 設計通り? | UX課題 | 備考 |
|------|-----|-----------|--------|------|
| [ ] トップページ | `/` | [ ] | | |
| [ ] おまかせ構成 | `/builder` | [ ] | | 予算・用途選択UI |
| [ ] おまかせ結果 | `/builder/result` | [ ] | | 結果0件時のEmpty State |
| [ ] カスタム構成 | `/configurator` | [ ] | | パーツ選択→自動推奨 |
| [ ] 構成詳細 | `/builds/[id]` | [ ] | | 編集/共有ボタン |
| [ ] ダッシュボード | `/dashboard` | [ ] | | 構成0件時のEmpty State |
| [ ] ログイン | `/signin` | [ ] | | エラー表示 |
| [ ] 新規登録 | `/signup` | [ ] | | バリデーション |
| [ ] 共有構成 | `/share` | [ ] | | OG画像プレビュー |

**確認質問:**
- [ ] 各画面のローディング状態は適切か？
- [ ] エラー状態（API失敗等）のハンドリングは十分か？
- [ ] キーボードナビゲーションは動作するか？

---

### 3.2 管理者向け画面（未実装）

| 画面 | URL | 実装優先度 | 備考 |
|------|-----|-----------|------|
| [ ] 管理ダッシュボード | `/admin` | 高 | |
| [ ] パーツ一覧 | `/admin/parts` | 高 | ページネーション要 |
| [ ] パーツ新規登録 | `/admin/parts/new` | 高 | 各カテゴリ対応 |
| [ ] パーツ編集 | `/admin/parts/[id]` | 高 | |
| [ ] プリセット一覧 | `/admin/presets` | 高 | |
| [ ] プリセット新規 | `/admin/presets/new` | 高 | |
| [ ] プリセット編集 | `/admin/presets/[id]` | 高 | |

---

## 4. APIエンドポイント検証

### 4.1 認証API

| エンドポイント | メソッド | 動作確認 | 備考 |
|---------------|---------|----------|------|
| [ ] `/api/v1/auth` | POST | [ ] | ユーザー登録 |
| [ ] `/api/v1/auth/sign_in` | POST | [ ] | ログイン |
| [ ] `/api/v1/auth/sign_out` | DELETE | [ ] | ログアウト |
| [ ] `/api/v1/auth/validate_token` | GET | [ ] | トークン検証 |

### 4.2 パーツAPI

| エンドポイント | メソッド | 動作確認 | 備考 |
|---------------|---------|----------|------|
| [ ] `/api/v1/parts` | GET | [ ] | フィルタリング動作 |
| [ ] `/api/v1/parts/:id` | GET | [ ] | category必須 |

### 4.3 プリセットAPI

| エンドポイント | メソッド | 動作確認 | 備考 |
|---------------|---------|----------|------|
| [ ] `/api/v1/presets` | GET | [ ] | budget/use_case検索 |
| [ ] `/api/v1/presets/:id` | GET | [ ] | |

### 4.4 構成API

| エンドポイント | メソッド | 動作確認 | 備考 |
|---------------|---------|----------|------|
| [ ] `/api/v1/builds` | GET | [ ] | 要認証 |
| [ ] `/api/v1/builds/:id` | GET | [ ] | 共有時は認証不要 |
| [ ] `/api/v1/builds` | POST | [ ] | 要認証 |
| [ ] `/api/v1/builds/:id` | PATCH | [ ] | 要認証、所有者のみ |
| [ ] `/api/v1/builds/:id` | DELETE | [ ] | 要認証、所有者のみ |
| [ ] `/api/v1/builds/shared/:token` | GET | [ ] | 認証不要 |

### 4.5 管理者API

| エンドポイント | メソッド | 動作確認 | 備考 |
|---------------|---------|----------|------|
| [ ] `/api/v1/admin/parts` | POST | [ ] | 要Admin権限 |
| [ ] `/api/v1/admin/parts/:id` | PATCH | [ ] | |
| [ ] `/api/v1/admin/parts/:id` | DELETE | [ ] | |
| [ ] `/api/v1/admin/presets` | POST | [ ] | |
| [ ] `/api/v1/admin/presets/:id` | PATCH | [ ] | |
| [ ] `/api/v1/admin/presets/:id` | DELETE | [ ] | |

---

## 5. プロダクト品質向上のための検討事項

### 5.1 セキュリティ

| 項目 | 現状 | 対応要否 | 優先度 |
|------|------|----------|--------|
| [ ] ログイン試行制限（5回失敗で15分ロック） | 未確認 | [ ] 要確認 | 高 |
| [ ] パスワード要件（8文字以上、英数字混合） | 未確認 | [ ] 要確認 | 高 |
| [ ] CSRF対策 | Rails標準 | [ ] 確認済 | - |
| [ ] XSS対策 | React標準 | [ ] 確認済 | - |
| [ ] SQLインジェクション対策 | ActiveRecord | [ ] 確認済 | - |
| [ ] レート制限（API） | 未実装？ | [ ] 要検討 | 中 |
| [ ] セキュリティヘッダー（CSP等） | 未確認 | [ ] 要確認 | 中 |

**質問:**
- 本番環境での HTTPS 設定は完了予定か？
- 環境変数（シークレット）の管理方針は？

---

### 5.2 パフォーマンス

| 項目 | 現状 | 対応要否 | 優先度 |
|------|------|----------|--------|
| [ ] 初回ロード時間 | 未計測 | [ ] 計測要 | 中 |
| [ ] APIレスポンス時間 | 未計測 | [ ] 計測要 | 中 |
| [ ] 画像最適化 | 未確認 | [ ] 要確認 | 低 |
| [ ] バンドルサイズ | 未確認 | [ ] 要確認 | 低 |
| [ ] DBインデックス | 未確認 | [ ] 要確認 | 中 |

---

### 5.3 UX/アクセシビリティ

| 項目 | 現状 | 対応要否 | 優先度 |
|------|------|----------|--------|
| [ ] 見出し階層（h1〜h3） | 設計あり | [ ] 実装確認 | 中 |
| [ ] aria-label（アイコンボタン） | 設計あり | [ ] 実装確認 | 中 |
| [ ] フォーカスリング | 設計あり | [ ] 実装確認 | 中 |
| [ ] キーボード操作 | 設計あり | [ ] 実装確認 | 中 |
| [ ] エラーメッセージの明確さ | 未確認 | [ ] 要確認 | 高 |
| [ ] 色のコントラスト | 未確認 | [ ] 要確認 | 中 |
| [ ] スクリーンリーダー対応 | 未確認 | [ ] 要確認 | 低 |

---

### 5.4 運用・保守

| 項目 | 現状 | 対応要否 | 優先度 |
|------|------|----------|--------|
| [ ] エラー監視（Sentry等） | 未導入？ | [ ] 要検討 | 中 |
| [ ] ログ出力 | 未確認 | [ ] 要確認 | 中 |
| [ ] バックアップ戦略 | 未定義？ | [ ] 要検討 | 高 |
| [ ] デプロイ手順 | ドキュメントあり | [ ] 確認要 | - |
| [ ] 環境分離（dev/staging/prod） | 未確認 | [ ] 要確認 | 中 |

---

## 6. v1.0 リリース前 必須タスク

### 6.1 必須（ブロッカー）

- [ ] **管理者画面UI実装** - パーツ・プリセット管理ができないとデータ投入不可
- [ ] **シードデータ投入** - 初期パーツデータがないと動作確認不可
- [ ] **E2Eテスト（最低限）** - 主要フロー（おまかせ/カスタム/保存/共有）
- [ ] **セキュリティ設定確認** - HTTPS、環境変数、認証周り

### 6.2 推奨（品質向上）

- [ ] パフォーマンス計測・改善
- [ ] アクセシビリティ監査（Lighthouse等）
- [ ] エラー監視導入
- [ ] レスポンシブ実機テスト

### 6.3 将来課題（v1.1以降）

- [ ] NextAuth.js v4 → v5 アップグレード
- [ ] 価格.com API連携（Phase 2）
- [ ] Keepa API連携（Phase 2）
- [ ] ユーザー管理画面（FR-103）
- [ ] PWA対応
- [ ] 多言語対応

---

## 7. 議論ポイント

以下の点について、認識を合わせたい：

### 7.1 スコープ確認

1. **v1.0のゴールは何か？**
   - [ ] 個人利用レベル（自分が使える）
   - [ ] 外部公開レベル（他人に見せられる）
   - [ ] プロダクトレベル（課金・集客を見据える）

2. **管理者画面の必要性**
   - [ ] v1.0で必須
   - [ ] シードデータで代用し、v1.1で対応

3. **テストカバレッジ目標**
   - [ ] 主要フローのE2Eのみ
   - [ ] ユニットテスト80%以上
   - [ ] 現状のままでOK

---

### 7.2 技術的判断

1. **認証方式**
   - 現状: NextAuth.js (v4) + Rails JWT検証
   - 質問: この構成で問題ないか？v5移行の優先度は？

2. **デプロイ先**
   - 想定: Vercel (Frontend) + Render/Railway (Backend)?
   - 質問: インフラ構成は確定しているか？

3. **DB運用**
   - 想定: PlanetScale / Neon / RDS?
   - 質問: データバックアップ・復旧の方針は？

---

### 7.3 ビジネス判断（該当する場合）

1. **利用規約・プライバシーポリシー**
   - [ ] 作成済み
   - [ ] 作成予定
   - [ ] 不要（個人利用のため）

2. **分析・トラッキング**
   - [ ] Google Analytics導入予定
   - [ ] 不要

---

## 8. 次のアクション

会議で以下を決定する：

1. [ ] v1.0 スコープの最終確定
2. [ ] 管理者画面実装の優先度確定
3. [ ] セキュリティ・インフラの確認担当
4. [ ] リリーススケジュール（目標日）

---

## 9. 改訂履歴

| 日付 | 内容 |
|------|------|
| 2026-01-29 | 初版作成 |
