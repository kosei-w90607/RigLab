name: Daily Price Fetch
on:
  schedule:
    - cron: '0 18 * * *'  # UTC 18:00 = JST 3:00
  workflow_dispatch: # 手動トリガーも可能

jobs:
  fetch-prices:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger price fetch
        env:
          RENDER_API_URL: ${{ secrets.RENDER_API_URL }}
          CRON_SECRET: ${{ secrets.CRON_SECRET }}
        run: |
          curl -sf -X POST \
            "${RENDER_API_URL}/api/v1/cron/price_fetch" \
            -H "Authorization: Bearer ${CRON_SECRET}"
